{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Hello,\r\n\r\nIn python 3.6.0, the cdef classes with cpdef methods cannot be pickled.\r\nThe problem doesn't appears with python 3.5.3.\r\n\r\nI'm using cython 0.25.2.\r\n\r\nYou can find below a package structure to reproduce it.\r\n\r\nThanks a lot for your help.\r\nBest regards.\r\n\r\nPackage structure:\r\n```\r\nâ”œâ”€â”€ lib\r\nâ”‚Â Â  â”œâ”€â”€ cy.pxd\r\nâ”‚Â Â  â”œâ”€â”€ cy.pyx\r\nâ”‚Â Â  â”œâ”€â”€ __init__.py\r\n|â”€â”€ main.py\r\n```\r\n\r\nCode:\r\n\r\n```python\r\n######################### lib/cy.pxd #########################\r\n\r\ncdef class WithoutC:\r\n    def hello(self):\r\n        return \"Hello, World\"\r\ncdef class WithCPDef:\r\n    cpdef str hello(self):\r\n        return \"Hello, World\"\r\ncdef class WithCDefWrapper:\r\n    def hello(self):\r\n        return _helloC(self)\r\ncpdef _helloC(object caller):\r\n    return \"Hello, World\"\r\n\r\n######################### lib/cy.pxd #########################\r\n\r\ncdef class WithoutCPDef:\r\n    pass\r\ncdef class WithCPDef:\r\n    cpdef str hello(self)\r\ncdef class WithCDefWrapper:\r\n    pass\r\ncpdef _helloC(object caller)\r\n\r\n######################### lib/init.py #########################\r\n\r\nimport pyximport\r\nimport numpy\r\npyximport.install(\r\n    pyximport=True,\r\n    pyimport=False,\r\n    build_dir=None,\r\n    build_in_temp=True,\r\n    reload_support=False,\r\n    load_py_module_on_import_failure=False,\r\n    inplace=False,\r\n    language_level=3,\r\n    setup_args={'include_dirs': numpy.get_include()}\r\n)\r\n\r\n######################### main.py #########################\r\n\r\n#!/usr/bin/env python3\r\n\r\nimport pickle as pkl\r\nimport os\r\nfrom lib.cy import WithoutC, WithCPDef, WithCDefWrapper\r\ndef tryThis(obj):\r\n    print(\"Pickling %s ...\" % obj.__class__.__name__)\r\n    try:\r\n        pkl.dump(obj, open(\"test.pkl\", \"wb\"))\r\n        print(\"\\t... OK\")\r\n    except Exception as e:\r\n        print(\"\\t... KO: %s\" % str(e))\r\nfor t in WithoutC(), WithCPDef(), WithCDefWrapper():\r\n    tryThis(t)\r\nif os.path.exists(\"test.pkl\"):\r\n    os.remove(\"test.pkl\")\r\n```\r\n\r\nOutput with python 3.5.3:\r\n```\r\nPickling WithoutC ...\r\n\t... OK\r\nPickling WithCPDef ...\r\n\t... OK\r\nPickling WithCDefWrapper ...\r\n\t... OK\r\n```\r\n\r\nOutput with python 3.6.0:\r\n```\r\nPickling WithoutC ...\r\n\t... OK\r\nPickling WithCPDef ...\r\n\t... KO: can't pickle lib.cy.WithCPDef objects\r\nPickling WithCDefWrapper ...\r\n\t... OK\r\n```",
    "closed_at": "2018-03-12T20:48:39Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "Looks like this was only added in PR ( https://github.com/cython/cython/pull/1708 ). So not sure why it would have worked before if it wasn't actually supported. ðŸ˜• In any event, this probably should be closed.\r\n\r\nEdit: On second look, [maybe not]( https://github.com/cython/cython/pull/1708/files#diff-1cbb0854b3f1695a32f7f1611f5107ebR146 )? Clarification from someone more involved with the Cython project would be helpful.",
            "created_at": "2018-03-12T20:24:42Z",
            "html_url": "https://github.com/cython/cython/issues/1606#issuecomment-372450308",
            "id": 372450308,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1606",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjQ1MDMwOA==",
            "updated_at": "2018-03-12T20:26:06Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/372450308",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4",
                "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
                "followers_url": "https://api.github.com/users/jakirkham/followers",
                "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
                "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jakirkham",
                "id": 3019665,
                "login": "jakirkham",
                "node_id": "MDQ6VXNlcjMwMTk2NjU=",
                "organizations_url": "https://api.github.com/users/jakirkham/orgs",
                "received_events_url": "https://api.github.com/users/jakirkham/received_events",
                "repos_url": "https://api.github.com/users/jakirkham/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jakirkham"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Thanks for the test case. It works for me in Py3.[567], so I'll close this ticket.",
            "created_at": "2018-03-12T20:49:40Z",
            "html_url": "https://github.com/cython/cython/issues/1606#issuecomment-372457600",
            "id": 372457600,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1606",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjQ1NzYwMA==",
            "updated_at": "2018-03-12T20:49:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/372457600",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks a lot guys!",
            "created_at": "2018-03-14T19:55:38Z",
            "html_url": "https://github.com/cython/cython/issues/1606#issuecomment-373154093",
            "id": 373154093,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1606",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzE1NDA5Mw==",
            "updated_at": "2018-03-14T19:55:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/373154093",
            "user": {
                "avatar_url": "https://avatars3.githubusercontent.com/u/7373718?v=4",
                "events_url": "https://api.github.com/users/mhooreman/events{/privacy}",
                "followers_url": "https://api.github.com/users/mhooreman/followers",
                "following_url": "https://api.github.com/users/mhooreman/following{/other_user}",
                "gists_url": "https://api.github.com/users/mhooreman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mhooreman",
                "id": 7373718,
                "login": "mhooreman",
                "node_id": "MDQ6VXNlcjczNzM3MTg=",
                "organizations_url": "https://api.github.com/users/mhooreman/orgs",
                "received_events_url": "https://api.github.com/users/mhooreman/received_events",
                "repos_url": "https://api.github.com/users/mhooreman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mhooreman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mhooreman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mhooreman"
            }
        },
        {
            "author_association": "NONE",
            "body": "I want to pickle a list of fasttext model . dump is OK, but load the model to doing predict will be exit unexpectedly without any error information.",
            "created_at": "2018-05-10T11:21:21Z",
            "html_url": "https://github.com/cython/cython/issues/1606#issuecomment-388026315",
            "id": 388026315,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1606",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODAyNjMxNQ==",
            "updated_at": "2018-05-10T11:21:21Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/388026315",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/8588160?v=4",
                "events_url": "https://api.github.com/users/cxh123/events{/privacy}",
                "followers_url": "https://api.github.com/users/cxh123/followers",
                "following_url": "https://api.github.com/users/cxh123/following{/other_user}",
                "gists_url": "https://api.github.com/users/cxh123/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cxh123",
                "id": 8588160,
                "login": "cxh123",
                "node_id": "MDQ6VXNlcjg1ODgxNjA=",
                "organizations_url": "https://api.github.com/users/cxh123/orgs",
                "received_events_url": "https://api.github.com/users/cxh123/received_events",
                "repos_url": "https://api.github.com/users/cxh123/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cxh123/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cxh123/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cxh123"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@cxh123, could you please raise a new issue with an MRE and versions used (Python, Cython, and anything else relevant)?",
            "created_at": "2018-05-25T02:01:32Z",
            "html_url": "https://github.com/cython/cython/issues/1606#issuecomment-391918842",
            "id": 391918842,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1606",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTkxODg0Mg==",
            "updated_at": "2018-05-25T02:01:32Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/391918842",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/3019665?v=4",
                "events_url": "https://api.github.com/users/jakirkham/events{/privacy}",
                "followers_url": "https://api.github.com/users/jakirkham/followers",
                "following_url": "https://api.github.com/users/jakirkham/following{/other_user}",
                "gists_url": "https://api.github.com/users/jakirkham/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jakirkham",
                "id": 3019665,
                "login": "jakirkham",
                "node_id": "MDQ6VXNlcjMwMTk2NjU=",
                "organizations_url": "https://api.github.com/users/jakirkham/orgs",
                "received_events_url": "https://api.github.com/users/jakirkham/received_events",
                "repos_url": "https://api.github.com/users/jakirkham/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jakirkham/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jakirkham/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jakirkham"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1606/comments",
    "created_at": "2017-02-15T07:53:15Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": "ec95e0e1bef519f3a5206bb013b643dd79988809",
            "commit_url": "https://api.github.com/repos/cython/cython/commits/ec95e0e1bef519f3a5206bb013b643dd79988809",
            "created_at": "2018-03-12T20:48:39Z",
            "event": "referenced",
            "id": 1517229999,
            "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDE1MTcyMjk5OTk=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1517229999"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": "ec95e0e1bef519f3a5206bb013b643dd79988809",
            "commit_url": "https://api.github.com/repos/cython/cython/commits/ec95e0e1bef519f3a5206bb013b643dd79988809",
            "created_at": "2018-03-12T20:48:39Z",
            "event": "closed",
            "id": 1517230007,
            "node_id": "MDExOkNsb3NlZEV2ZW50MTUxNzIzMDAwNw==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1517230007"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-03-12T20:48:52Z",
            "event": "labeled",
            "id": 1517230392,
            "label": {
                "color": "444444",
                "name": "R: worksforme"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDE1MTcyMzAzOTI=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1517230392"
        },
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/8588160?v=4",
                "events_url": "https://api.github.com/users/cxh123/events{/privacy}",
                "followers_url": "https://api.github.com/users/cxh123/followers",
                "following_url": "https://api.github.com/users/cxh123/following{/other_user}",
                "gists_url": "https://api.github.com/users/cxh123/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cxh123",
                "id": 8588160,
                "login": "cxh123",
                "node_id": "MDQ6VXNlcjg1ODgxNjA=",
                "organizations_url": "https://api.github.com/users/cxh123/orgs",
                "received_events_url": "https://api.github.com/users/cxh123/received_events",
                "repos_url": "https://api.github.com/users/cxh123/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cxh123/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cxh123/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cxh123"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-05-25T02:01:32Z",
            "event": "mentioned",
            "id": 1645667111,
            "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MTY0NTY2NzExMQ==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1645667111"
        },
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/8588160?v=4",
                "events_url": "https://api.github.com/users/cxh123/events{/privacy}",
                "followers_url": "https://api.github.com/users/cxh123/followers",
                "following_url": "https://api.github.com/users/cxh123/following{/other_user}",
                "gists_url": "https://api.github.com/users/cxh123/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cxh123",
                "id": 8588160,
                "login": "cxh123",
                "node_id": "MDQ6VXNlcjg1ODgxNjA=",
                "organizations_url": "https://api.github.com/users/cxh123/orgs",
                "received_events_url": "https://api.github.com/users/cxh123/received_events",
                "repos_url": "https://api.github.com/users/cxh123/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cxh123/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cxh123/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cxh123"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-05-25T02:01:32Z",
            "event": "subscribed",
            "id": 1645667114,
            "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDE2NDU2NjcxMTQ=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1645667114"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1606/events",
    "html_url": "https://github.com/cython/cython/issues/1606",
    "id": 207731185,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "id": 425556354,
            "name": "R: worksforme",
            "node_id": "MDU6TGFiZWw0MjU1NTYzNTQ=",
            "url": "https://api.github.com/repos/cython/cython/labels/R:%20worksforme"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1606/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUyMDc3MzExODU=",
    "number": 1606,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "python 3.6: cdef classes with cpdef methods cannot be pickled",
    "updated_at": "2018-05-25T02:01:32Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1606",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/7373718?v=4",
        "events_url": "https://api.github.com/users/mhooreman/events{/privacy}",
        "followers_url": "https://api.github.com/users/mhooreman/followers",
        "following_url": "https://api.github.com/users/mhooreman/following{/other_user}",
        "gists_url": "https://api.github.com/users/mhooreman/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/mhooreman",
        "id": 7373718,
        "login": "mhooreman",
        "node_id": "MDQ6VXNlcjczNzM3MTg=",
        "organizations_url": "https://api.github.com/users/mhooreman/orgs",
        "received_events_url": "https://api.github.com/users/mhooreman/received_events",
        "repos_url": "https://api.github.com/users/mhooreman/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/mhooreman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mhooreman/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/mhooreman"
    }
}