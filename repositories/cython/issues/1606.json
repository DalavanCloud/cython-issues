{
    "assignee": null,
    "assignees": [],
    "body": "Hello,\r\n\r\nIn python 3.6.0, the cdef classes with cpdef methods cannot be pickled.\r\nThe problem doesn't appears with python 3.5.3.\r\n\r\nI'm using cython 0.25.2.\r\n\r\nYou can find below a package structure to reproduce it.\r\n\r\nThanks a lot for your help.\r\nBest regards.\r\n\r\nPackage structure:\r\n```\r\n├── lib\r\n│   ├── cy.pxd\r\n│   ├── cy.pyx\r\n│   ├── __init__.py\r\n|── main.py\r\n```\r\n\r\nCode:\r\n\r\n```python\r\n######################### lib/cy.pxd #########################\r\n\r\ncdef class WithoutC:\r\n    def hello(self):\r\n        return \"Hello, World\"\r\ncdef class WithCPDef:\r\n    cpdef str hello(self):\r\n        return \"Hello, World\"\r\ncdef class WithCDefWrapper:\r\n    def hello(self):\r\n        return _helloC(self)\r\ncpdef _helloC(object caller):\r\n    return \"Hello, World\"\r\n\r\n######################### lib/cy.pxd #########################\r\n\r\ncdef class WithoutCPDef:\r\n    pass\r\ncdef class WithCPDef:\r\n    cpdef str hello(self)\r\ncdef class WithCDefWrapper:\r\n    pass\r\ncpdef _helloC(object caller)\r\n\r\n######################### lib/init.py #########################\r\n\r\nimport pyximport\r\nimport numpy\r\npyximport.install(\r\n    pyximport=True,\r\n    pyimport=False,\r\n    build_dir=None,\r\n    build_in_temp=True,\r\n    reload_support=False,\r\n    load_py_module_on_import_failure=False,\r\n    inplace=False,\r\n    language_level=3,\r\n    setup_args={'include_dirs': numpy.get_include()}\r\n)\r\n\r\n######################### main.py #########################\r\n\r\n#!/usr/bin/env python3\r\n\r\nimport pickle as pkl\r\nimport os\r\nfrom lib.cy import WithoutC, WithCPDef, WithCDefWrapper\r\ndef tryThis(obj):\r\n    print(\"Pickling %s ...\" % obj.__class__.__name__)\r\n    try:\r\n        pkl.dump(obj, open(\"test.pkl\", \"wb\"))\r\n        print(\"\\t... OK\")\r\n    except Exception as e:\r\n        print(\"\\t... KO: %s\" % str(e))\r\nfor t in WithoutC(), WithCPDef(), WithCDefWrapper():\r\n    tryThis(t)\r\nif os.path.exists(\"test.pkl\"):\r\n    os.remove(\"test.pkl\")\r\n```\r\n\r\nOutput with python 3.5.3:\r\n```\r\nPickling WithoutC ...\r\n\t... OK\r\nPickling WithCPDef ...\r\n\t... OK\r\nPickling WithCDefWrapper ...\r\n\t... OK\r\n```\r\n\r\nOutput with python 3.6.0:\r\n```\r\nPickling WithoutC ...\r\n\t... OK\r\nPickling WithCPDef ...\r\n\t... KO: can't pickle lib.cy.WithCPDef objects\r\nPickling WithCDefWrapper ...\r\n\t... OK\r\n```",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1606/comments",
    "created_at": "2017-02-15T07:53:15Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1606/events",
    "html_url": "https://github.com/cython/cython/issues/1606",
    "id": 207731185,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1606/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1606,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "python 3.6: cdef classes with cpdef methods cannot be pickled",
    "updated_at": "2017-02-15T08:10:22Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1606",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/7373718?v=3",
        "events_url": "https://api.github.com/users/mhooreman/events{/privacy}",
        "followers_url": "https://api.github.com/users/mhooreman/followers",
        "following_url": "https://api.github.com/users/mhooreman/following{/other_user}",
        "gists_url": "https://api.github.com/users/mhooreman/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/mhooreman",
        "id": 7373718,
        "login": "mhooreman",
        "organizations_url": "https://api.github.com/users/mhooreman/orgs",
        "received_events_url": "https://api.github.com/users/mhooreman/received_events",
        "repos_url": "https://api.github.com/users/mhooreman/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/mhooreman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mhooreman/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/mhooreman"
    }
}