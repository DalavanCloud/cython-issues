{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "cython compiled .py file:\r\ncython_test.py\r\n```python\r\nimport threading,time\r\n\r\ndef thread_func():\r\n    print(\"Running at {}\".format(time.time()))\r\n    print(\"Still Running at {}\".format(time.time()))\r\n    print(\"Still Running!\")\r\n\r\ndef test():\r\n    f = threading.Thread(target=thread_func)\r\n    f.start()\r\n    st = time.time()\r\n    while time.time() - st < 5:\r\n        pass\r\n    print(\"main thread done\")\r\n```\r\nThis file is compiled with `cythonize(\"cython_test.py\")`\r\n\r\nTest file:\r\n```python\r\nimport cython_test # Cython Compiled\r\ncython_test.run()\r\n```\r\n### Normal behavior with python:\r\nprint \"_Running at xxx_\" and \"_Still Running at xxx_\" in a sequence, with no interval more than 5s and before main thread prints : \"_main thread done_\"\r\n```\r\nRunning at X\r\nStill Running at X\r\nStill Running!\r\nmain thread done\r\n```\r\n\r\n### Cython compiled py file's behavior:\r\n the first \"Running at\" prints right away, but the second \"Still Running at \" print after \"_main thread done_ \" displayed.\r\n```\r\nRunning at X\r\nmain thread done\r\nStill Running at X\r\nStill Running!\r\n```\r\n\r\nTested on Python 3.7.1; Cython 0.29 ; Ubuntu 16.04\r\n\r\n======\r\n\r\nIs that saying cython never switch back to thread_func once it context switched to main thread?",
    "closed_at": "2018-11-02T15:31:31Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "CPython frees the GIL every couple of byte code executions and can thus switch threads between any two byte codes. Cython does not have byte code. I/O operations might still free the GIL, however, but in any case, that's outside of Cython's control.\r\n\r\nYour example code implements a busy loop in the main thread that does not allow other threads to run, since it does not free the GIL. If you want to allow other threads to run, either free the GIL when you don't need it, or release and re-acquire it every so-many operations to allow for a thread-switch. In any case, as long as you require the GIL in more than one thread, you will not get any parallelism.",
            "created_at": "2018-11-02T15:31:31Z",
            "html_url": "https://github.com/cython/cython/issues/2698#issuecomment-435418661",
            "id": 435418661,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2698",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTQxODY2MQ==",
            "updated_at": "2018-11-02T15:31:31Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/435418661",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "NONE",
            "body": "Get it, thanks",
            "created_at": "2018-11-05T04:21:27Z",
            "html_url": "https://github.com/cython/cython/issues/2698#issuecomment-435751162",
            "id": 435751162,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2698",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTc1MTE2Mg==",
            "updated_at": "2018-11-05T04:21:27Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/435751162",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/44489431?v=4",
                "events_url": "https://api.github.com/users/Patton-L/events{/privacy}",
                "followers_url": "https://api.github.com/users/Patton-L/followers",
                "following_url": "https://api.github.com/users/Patton-L/following{/other_user}",
                "gists_url": "https://api.github.com/users/Patton-L/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Patton-L",
                "id": 44489431,
                "login": "Patton-L",
                "node_id": "MDQ6VXNlcjQ0NDg5NDMx",
                "organizations_url": "https://api.github.com/users/Patton-L/orgs",
                "received_events_url": "https://api.github.com/users/Patton-L/received_events",
                "repos_url": "https://api.github.com/users/Patton-L/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Patton-L/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Patton-L/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Patton-L"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2698/comments",
    "created_at": "2018-11-02T11:36:43Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-11-02T15:31:31Z",
            "event": "closed",
            "id": 1943243354,
            "node_id": "MDExOkNsb3NlZEV2ZW50MTk0MzI0MzM1NA==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1943243354"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2698/events",
    "html_url": "https://github.com/cython/cython/issues/2698",
    "id": 376775219,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2698/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUzNzY3NzUyMTk=",
    "number": 2698,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Cython bug on threading?",
    "updated_at": "2018-11-05T04:21:27Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2698",
    "user": {
        "avatar_url": "https://avatars1.githubusercontent.com/u/44489431?v=4",
        "events_url": "https://api.github.com/users/Patton-L/events{/privacy}",
        "followers_url": "https://api.github.com/users/Patton-L/followers",
        "following_url": "https://api.github.com/users/Patton-L/following{/other_user}",
        "gists_url": "https://api.github.com/users/Patton-L/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Patton-L",
        "id": 44489431,
        "login": "Patton-L",
        "node_id": "MDQ6VXNlcjQ0NDg5NDMx",
        "organizations_url": "https://api.github.com/users/Patton-L/orgs",
        "received_events_url": "https://api.github.com/users/Patton-L/received_events",
        "repos_url": "https://api.github.com/users/Patton-L/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Patton-L/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Patton-L/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Patton-L"
    }
}