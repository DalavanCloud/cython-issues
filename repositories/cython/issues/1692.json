{
    "assignee": null,
    "assignees": [],
    "body": "The compiler doesn't seem to know where to find ``StopAsyncIteration``. I'm getting this error even when I use test code from the Cython repository.\r\n\r\nThe full error is:\r\n\r\n```\r\ncc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid for C/ObjC but not for C++\r\nhttpstan/sample.cpp: In function ‘PyObject* __pyx_gb_8httpstan_6sample_9AsyncIter_6generator(__pyx_CoroutineObject*, PyObject*)’:\r\nhttpstan/sample.cpp:1250:17: error: ‘__Pyx_PyExc_StopAsyncIteration’ was not declared in this scope\r\n     __Pyx_Raise(__Pyx_PyExc_StopAsyncIteration, 0, 0, 0);\r\n                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n```\r\n\r\nand the code I'm cythonizing (successfully) with ``cython -3 --cplus`` is:\r\n\r\n```\r\ncdef class AsyncIter:\r\n    cdef long i\r\n    cdef long aiter_calls\r\n    cdef long max_iter_calls\r\n\r\n    def __init__(self, long max_iter_calls=1):\r\n        self.i = 0\r\n        self.aiter_calls = 0\r\n        self.max_iter_calls = max_iter_calls\r\n\r\n    def __aiter__(self):\r\n        self.aiter_calls += 1\r\n        return self\r\n\r\n    async def __anext__(self):\r\n        self.i += 1\r\n        assert self.aiter_calls <= self.max_iter_calls\r\n\r\n        if self.i > 100:\r\n            raise StopAsyncIteration\r\n\r\n        return self.i, self.i\r\n```\r\n\r\nCython from master, Python 3.6 and Python 3.5.\r\n\r\nThanks for an amazing library!",
    "closed_at": null,
    "comment_data": [
        {
            "body": "I suppose the fully versions matter here. Python 3.5.3 and Python 3.6.1rc1.\r\n\r\nIf I trim off the leading `__Pyx_` from `__Pyx_PyExc_StopAsyncIteration` (I looked in ``pyerrors.h``) it compiles without problems and works. I'm sure this is a dangerous thing to do.",
            "created_at": "2017-05-01T23:15:40Z",
            "html_url": "https://github.com/cython/cython/issues/1692#issuecomment-298457479",
            "id": 298457479,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1692",
            "updated_at": "2017-05-01T23:16:00Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/298457479",
            "user": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/19950?v=3",
                "events_url": "https://api.github.com/users/ariddell/events{/privacy}",
                "followers_url": "https://api.github.com/users/ariddell/followers",
                "following_url": "https://api.github.com/users/ariddell/following{/other_user}",
                "gists_url": "https://api.github.com/users/ariddell/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ariddell",
                "id": 19950,
                "login": "ariddell",
                "organizations_url": "https://api.github.com/users/ariddell/orgs",
                "received_events_url": "https://api.github.com/users/ariddell/received_events",
                "repos_url": "https://api.github.com/users/ariddell/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ariddell/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ariddell/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ariddell"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1692/comments",
    "created_at": "2017-05-01T22:57:47Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars1.githubusercontent.com/u/19950?v=3",
                "events_url": "https://api.github.com/users/ariddell/events{/privacy}",
                "followers_url": "https://api.github.com/users/ariddell/followers",
                "following_url": "https://api.github.com/users/ariddell/following{/other_user}",
                "gists_url": "https://api.github.com/users/ariddell/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ariddell",
                "id": 19950,
                "login": "ariddell",
                "organizations_url": "https://api.github.com/users/ariddell/orgs",
                "received_events_url": "https://api.github.com/users/ariddell/received_events",
                "repos_url": "https://api.github.com/users/ariddell/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ariddell/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ariddell/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ariddell"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2017-05-01T22:58:08Z",
            "event": "renamed",
            "id": 1064659257,
            "rename": {
                "from": "'__Pyx_PyExc_StopAsyncIteration’ not found by compiler",
                "to": "'__Pyx_PyExc_StopAsyncIteration’ / StopAsyncIteration not found by compiler"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/1064659257"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1692/events",
    "html_url": "https://github.com/cython/cython/issues/1692",
    "id": 225548743,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1692/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1692,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "'__Pyx_PyExc_StopAsyncIteration’ / StopAsyncIteration not found by compiler",
    "updated_at": "2017-05-01T23:16:00Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1692",
    "user": {
        "avatar_url": "https://avatars1.githubusercontent.com/u/19950?v=3",
        "events_url": "https://api.github.com/users/ariddell/events{/privacy}",
        "followers_url": "https://api.github.com/users/ariddell/followers",
        "following_url": "https://api.github.com/users/ariddell/following{/other_user}",
        "gists_url": "https://api.github.com/users/ariddell/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ariddell",
        "id": 19950,
        "login": "ariddell",
        "organizations_url": "https://api.github.com/users/ariddell/orgs",
        "received_events_url": "https://api.github.com/users/ariddell/received_events",
        "repos_url": "https://api.github.com/users/ariddell/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ariddell/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ariddell/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ariddell"
    }
}