{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Cython crashes when it attempts to compile code on an FIPS-enabled system, because the md5 hashlib is disabled, as you can see in the log excerpt below (emphasis on the key error message mine):\r\n\r\n`   ------------------------------------------------------------\r\n\r\n    TestClass:8:5: Compiler crash in AnalyseDeclarationsTransform\r\n\r\n    ModuleNode.body = StatListNode(TestClass:4:0)\r\n    StatListNode.stats[1] = CnameDecoratorNode(TestClass:8:5,\r\n        cname = '__pyx_TestClass')\r\n\r\n    Compiler crash traceback from this point on:\r\n      File \"Cython/Compiler/Visitor.py\", line 180, in Cython.Compiler.Visitor.TreeVisitor._visit\r\n      File \"/tmp/pip-build-env-za1cx7s2/lib64/python3.4/site-packages/Cython/Compiler/ParseTreeTransforms.py\", line 1635, in visit_CClassDefNode\r\n        self._inject_pickle_methods(node)\r\n      File \"/tmp/pip-build-env-za1cx7s2/lib64/python3.4/site-packages/Cython/Compiler/ParseTreeTransforms.py\", line 1703, in _inject_pickle_methods\r\n        checksum = '0x%s' % hashlib.md5(' '.join(all_members_names).encode('utf-8')).hexdigest()[:7]\r\n    **ValueError: error:060800A3:digital envelope routines:EVP_DigestInit_ex:disabled for fips**\r\n    building 'cartopy.geodesic._geodesic' extension\r\n    creating build/temp.linux-x86_64-3.4/lib/cartopy/geodesic\r\n    /usr/bin/gcc -Wno-unused-result -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -I/opt/rh/rh-python34/root/usr/include -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/opt/rh/rh-python34/root/usr/include -I/tmp/pip-build-env-za1cx7s2/lib64/python3.4/site-packages/numpy/core/include -I/opt/rh/rh-python34/root/usr/include/python3.4m -c lib/cartopy/geodesic/_geodesic.c -o build/temp.linux-x86_64-3.4/lib/cartopy/geodesic/_geodesic.o\r\n    lib/cartopy/geodesic/_geodesic.c:1:2: error: #error Do not use this file, it is the result of a failed Cython compilation.\r\n     #error Do not use this file, it is the result of a failed Cython compilation.\r\n      ^\r\n    error: command '/usr/bin/gcc' failed with exit status 1\r\n`\r\nIs there a way to tell Cython to use an alternate hashlib, such as sha256? If not, there needs to be, because as it stands, no python package that requires Cython compiles can be built on any FIPS-enabled system. This is a serious, show-stopping problem.",
    "closed_at": "2019-01-08T19:56:38Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "(rolling eyes) … I wonder what the problem is that people have with MD5 for *non*-cryptographic use cases…\r\n\r\nIn case others are interested, FIPS is some certification standard from the USA: https://en.wikipedia.org/wiki/FIPS_140-2\r\n\r\nMD5 is actually in the list of guaranteed algorithms (Py3.7):\r\n```python\r\n>>> import hashlib\r\n>>> hashlib.algorithms_guaranteed\r\n{'sha3_224', 'sha3_384', 'shake_256', 'shake_128', 'sha256', 'sha1', 'sha384', 'sha512', 'blake2b', 'sha3_512', 'md5', 'blake2s', 'sha224', 'sha3_256'}\r\n```\r\n\r\nWhat hashes are available in your environment? SHA-1? I know, that's considered broken, too, but it's the fastest I have on my side, about twice as fast for me as SHA-256 (and actually a bit faster than MD-5). Funny enough, even SHA-512 is faster than SHA-256 for me. Might be a 64bit optimisation thing.\r\n\r\nAlso note that this only regards the Cython compiler itself. Cython generated modules are not impacted by this and should work just fine on a FIPS system.",
            "created_at": "2019-01-08T18:12:54Z",
            "html_url": "https://github.com/cython/cython/issues/2790#issuecomment-452397488",
            "id": 452397488,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2790",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjM5NzQ4OA==",
            "updated_at": "2019-01-08T18:12:54Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/452397488",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I changed the file fingerprinting to SHA-1 for 3.0. Thanks for the report.",
            "created_at": "2019-01-08T19:57:05Z",
            "html_url": "https://github.com/cython/cython/issues/2790#issuecomment-452431165",
            "id": 452431165,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2790",
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjQzMTE2NQ==",
            "updated_at": "2019-01-08T19:57:05Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/452431165",
            "user": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2790/comments",
    "created_at": "2019-01-08T15:17:36Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-01-08T19:46:14Z",
            "event": "milestoned",
            "id": 2061160372,
            "milestone": {
                "title": "3.0"
            },
            "node_id": "MDE1Ok1pbGVzdG9uZWRFdmVudDIwNjExNjAzNzI=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2061160372"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-01-08T19:47:17Z",
            "event": "labeled",
            "id": 2061162667,
            "label": {
                "color": "444444",
                "name": "enhancement"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDIwNjExNjI2Njc=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2061162667"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": "f00af64bcc2cef4c3fb1433ed670ab5f9970e2cd",
            "commit_url": "https://api.github.com/repos/cython/cython/commits/f00af64bcc2cef4c3fb1433ed670ab5f9970e2cd",
            "created_at": "2019-01-08T19:56:38Z",
            "event": "closed",
            "id": 2061183668,
            "node_id": "MDExOkNsb3NlZEV2ZW50MjA2MTE4MzY2OA==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2061183668"
        },
        {
            "actor": {
                "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2019-01-08T19:57:19Z",
            "event": "labeled",
            "id": 2061185223,
            "label": {
                "color": "444444",
                "name": "Build System"
            },
            "node_id": "MDEyOkxhYmVsZWRFdmVudDIwNjExODUyMjM=",
            "url": "https://api.github.com/repos/cython/cython/issues/events/2061185223"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2790/events",
    "html_url": "https://github.com/cython/cython/issues/2790",
    "id": 396952286,
    "labels": [
        {
            "color": "444444",
            "default": false,
            "id": 425556353,
            "name": "Build System",
            "node_id": "MDU6TGFiZWw0MjU1NTYzNTM=",
            "url": "https://api.github.com/repos/cython/cython/labels/Build%20System"
        },
        {
            "color": "444444",
            "default": true,
            "id": 425556243,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw0MjU1NTYyNDM=",
            "url": "https://api.github.com/repos/cython/cython/labels/enhancement"
        }
    ],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2790/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 19,
        "created_at": "2018-08-18T06:33:08Z",
        "creator": {
            "avatar_url": "https://avatars0.githubusercontent.com/u/491659?v=4",
            "events_url": "https://api.github.com/users/scoder/events{/privacy}",
            "followers_url": "https://api.github.com/users/scoder/followers",
            "following_url": "https://api.github.com/users/scoder/following{/other_user}",
            "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/scoder",
            "id": 491659,
            "login": "scoder",
            "node_id": "MDQ6VXNlcjQ5MTY1OQ==",
            "organizations_url": "https://api.github.com/users/scoder/orgs",
            "received_events_url": "https://api.github.com/users/scoder/received_events",
            "repos_url": "https://api.github.com/users/scoder/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/scoder"
        },
        "description": "Goals:\r\n– New version scheme: 3.x instead of 0.x.\r\n– Change default `language_level` from `2` to `3`.\r\n– Change default for `binding` directive from `False` to `True`.\r\n– Fix some Python compatibility issues (if possible, allowing for breaking changes).",
        "due_on": null,
        "html_url": "https://github.com/cython/cython/milestone/58",
        "id": 3580387,
        "labels_url": "https://api.github.com/repos/cython/cython/milestones/58/labels",
        "node_id": "MDk6TWlsZXN0b25lMzU4MDM4Nw==",
        "number": 58,
        "open_issues": 22,
        "state": "open",
        "title": "3.0",
        "updated_at": "2019-01-08T19:56:38Z",
        "url": "https://api.github.com/repos/cython/cython/milestones/58"
    },
    "node_id": "MDU6SXNzdWUzOTY5NTIyODY=",
    "number": 2790,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "Cython fails to build code on FIPS-enabled systems",
    "updated_at": "2019-01-08T19:57:19Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2790",
    "user": {
        "avatar_url": "https://avatars0.githubusercontent.com/u/46491872?v=4",
        "events_url": "https://api.github.com/users/Cynthia-Higginbotham/events{/privacy}",
        "followers_url": "https://api.github.com/users/Cynthia-Higginbotham/followers",
        "following_url": "https://api.github.com/users/Cynthia-Higginbotham/following{/other_user}",
        "gists_url": "https://api.github.com/users/Cynthia-Higginbotham/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Cynthia-Higginbotham",
        "id": 46491872,
        "login": "Cynthia-Higginbotham",
        "node_id": "MDQ6VXNlcjQ2NDkxODcy",
        "organizations_url": "https://api.github.com/users/Cynthia-Higginbotham/orgs",
        "received_events_url": "https://api.github.com/users/Cynthia-Higginbotham/received_events",
        "repos_url": "https://api.github.com/users/Cynthia-Higginbotham/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Cynthia-Higginbotham/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Cynthia-Higginbotham/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Cynthia-Higginbotham"
    }
}