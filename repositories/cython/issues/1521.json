{
    "assignee": null,
    "assignees": [],
    "body": "With this code:\r\n\r\n```\r\nfrom libcpp.map cimport map\r\n\r\ncdef class int_int_map:\r\n     cdef public map[long, long] _values\r\n\r\n     def __getitem__(self, k):\r\n         return self._values[k]\r\n\r\n     def __setitem__(self, k, v):\r\n         self._values[k] = v\r\n\r\n     def get(self, k):\r\n         return self._values.get(k)\r\n```\r\n\r\nI find that for 200,000 dictionary entries, the 'get' function is about 1m times slower than __getitem__ -- please see https://gist.github.com/ctb/ecea9809b8e1b6503abda1316b0de5b1 for a full working example. I'm sure I'm doing something wrong but I'm not sure what...\r\n\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "body": "Without trying it, I guess that `cython -a` would show you that calling `.get()` on a C++ map copies the map into a Python dict, then calls `.get()` on it, then throws away the dict. C++ doesn't have that method.\r\n\r\nWorks as designed.",
            "created_at": "2016-11-13T09:57:53Z",
            "html_url": "https://github.com/cython/cython/issues/1521#issuecomment-260176563",
            "id": 260176563,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1521",
            "updated_at": "2016-11-13T09:57:53Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/260176563",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=3",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "body": "ok, thanks.  I guess I'm surprised that 'get' works at all, then;\nshouldn't it be \"not defined\" on the Python side if it's not defined on\nthe C++ side, or alternatively do something smarter & faster?\n\nI'd be happy to put in a PR if the behavior should (or could) be changed.\n",
            "created_at": "2016-11-13T13:02:56Z",
            "html_url": "https://github.com/cython/cython/issues/1521#issuecomment-260184932",
            "id": 260184932,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1521",
            "updated_at": "2016-11-13T13:02:56Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/260184932",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51016?v=3",
                "events_url": "https://api.github.com/users/ctb/events{/privacy}",
                "followers_url": "https://api.github.com/users/ctb/followers",
                "following_url": "https://api.github.com/users/ctb/following{/other_user}",
                "gists_url": "https://api.github.com/users/ctb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ctb",
                "id": 51016,
                "login": "ctb",
                "organizations_url": "https://api.github.com/users/ctb/orgs",
                "received_events_url": "https://api.github.com/users/ctb/received_events",
                "repos_url": "https://api.github.com/users/ctb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ctb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ctb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ctb"
            }
        },
        {
            "body": "Actually, this is quite dangerous. Makes sense for primitives like complex, but imagine \r\n\r\n```\r\ncdef vector[int] v = ...\r\nv.pop()\r\n```\r\n\r\nI think we'd be better off with errors about missing methods here. ",
            "created_at": "2016-11-16T04:35:31Z",
            "html_url": "https://github.com/cython/cython/issues/1521#issuecomment-260852003",
            "id": 260852003,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1521",
            "updated_at": "2016-11-16T04:35:31Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/260852003",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1521/comments",
    "created_at": "2016-11-12T22:06:04Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=3",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-11-13T09:57:53Z",
            "event": "closed",
            "id": 856968445,
            "url": "https://api.github.com/repos/cython/cython/issues/events/856968445"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-11-16T04:34:11Z",
            "event": "reopened",
            "id": 860497416,
            "url": "https://api.github.com/repos/cython/cython/issues/events/860497416"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1521/events",
    "html_url": "https://github.com/cython/cython/issues/1521",
    "id": 188937551,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1521/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1521,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "libcpp.map.map 'get' is 1e6 slower than libcpp.map.map '__getitem__'",
    "updated_at": "2016-11-16T04:35:31Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1521",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/51016?v=3",
        "events_url": "https://api.github.com/users/ctb/events{/privacy}",
        "followers_url": "https://api.github.com/users/ctb/followers",
        "following_url": "https://api.github.com/users/ctb/following{/other_user}",
        "gists_url": "https://api.github.com/users/ctb/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ctb",
        "id": 51016,
        "login": "ctb",
        "organizations_url": "https://api.github.com/users/ctb/orgs",
        "received_events_url": "https://api.github.com/users/ctb/received_events",
        "repos_url": "https://api.github.com/users/ctb/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ctb/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ctb/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ctb"
    }
}