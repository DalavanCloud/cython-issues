{
    "assignee": null,
    "assignees": [],
    "body": "Hi cython devs, first of all, thank you for this all the work. \r\n\r\nI am trying to compile the cython part of my project using the `setup.py` script in the toplevel.\r\nI am able to compile my `cython` code when I put my `setup.py` script in the `cython` folder, \r\nbut when I move the `setup.py` to the parent directory of the `cython` folder then I am unable to compile my package, and I receive an error about the `cython` module itself. \r\n\r\n_Since the `cython` error is quite cryptic and only appears in the presence of special files that's why I thought of opening an issue instead of asking a question on SO._\r\n\r\n```python\r\nusing config files: \r\nDistribution.parse_config_files():\r\noptions (after parsing config files):\r\nno commands known yet\r\noptions (after parsing command line):\r\noption dict for 'build_ext' command:\r\n  {'inplace': ('command line', 1)}\r\nrunning build_ext\r\nDistribution.get_command_obj(): creating 'build_ext' command object\r\n  setting options for 'old_build_ext' command:\r\n    inplace = 1 (from command line)\r\nDistribution.get_command_obj(): creating 'build' command object\r\ncythoning cython/analyzer.pyx to cython/analyzer.cpp\r\nTraceback (most recent call last):\r\n  File \"setup.py\", line 21, in <module>\r\n    cmdclass=dict(build_ext=build_ext))\r\n  File \"/Users/username/anaconda/lib/python2.7/distutils/core.py\", line 151, in setup\r\n    dist.run_commands()\r\n  File \"/Users/username/anaconda/lib/python2.7/distutils/dist.py\", line 953, in run_commands\r\n    self.run_command(cmd)\r\n  File \"/Users/username/anaconda/lib/python2.7/distutils/dist.py\", line 972, in run_command\r\n    cmd_obj.run()\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Distutils/old_build_ext.py\", line 185, in run\r\n    _build_ext.build_ext.run(self)\r\n  File \"/Users/username/anaconda/lib/python2.7/distutils/command/build_ext.py\", line 339, in run\r\n    self.build_extensions()\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Distutils/old_build_ext.py\", line 192, in build_extensions\r\n    ext.sources = self.cython_sources(ext.sources, ext)\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Distutils/old_build_ext.py\", line 345, in cython_sources\r\n    full_module_name=module_name)\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Compiler/Main.py\", line 684, in compile\r\n    return compile_single(source, options, full_module_name)\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Compiler/Main.py\", line 634, in compile_single\r\n    return run_pipeline(source, options, full_module_name)\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Compiler/Main.py\", line 455, in run_pipeline\r\n    from . import Pipeline\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Compiler/Pipeline.py\", line 9, in <module>\r\n    from .Visitor import CythonTransform\r\n  File \"Cython/Compiler/Visitor.py\", line 14, in init Cython.Compiler.Visitor (/Users/ilan/minonda/conda-bld/cython_1481309365633/work/Cython-0.25.2/Cython/Compiler/Visitor.c:20843)\r\n  File \"/Users/username/anaconda/lib/python2.7/site-packages/Cython/Compiler/Nodes.py\", line 8, in <module>\r\n    cython.declare(sys=object, os=object, copy=object,\r\nAttributeError: 'module' object has no attribute 'declare'\r\n```\r\n\r\nThe following is my `setup.py` file\r\n``` python\r\nfrom distutils.core import setup\r\nfrom distutils.extension import Extension\r\nfrom Cython.Distutils import build_ext\r\nimport distutils.log\r\ndistutils.log.set_verbosity(distutils.log.DEBUG)\r\n\r\n# http://stackoverflow.com/questions/18423512/\r\n# calling-c-code-from-python-using-cython-whith-the-distutilis-approach\r\n# echo __ZN2cv3Mat10deallocateEv) | c++filt\r\nsetup(\r\n    name=\"analyzer\",\r\n    ext_modules=[\r\n        Extension(\"analyzer\",\r\n                  sources=[\"cython/analyzer.pyx\", \"cython/KrovetzStemmer.cpp\"],\r\n                  include_dirs=[\".\"],\r\n                  language='c++',\r\n                  # library_dirs=[],\r\n                  # libraries=['python2.7'],\r\n        ),\r\n    ],\r\n    cmdclass=dict(build_ext=build_ext))\r\n```\r\n\r\nand the following are the contents of my `cython` folder. \r\n```bash\r\n  cython/KrovetzStemmer.cpp\r\n  cython/KrovetzStemmer.hpp\r\n  cython/analyzer.pyx      \r\n  cython/krovetzstemmer.pxd\r\n cython/__init__.py\r\n```\r\n\r\n**NOTE: The error above only appears when my cython subfolder contains __init__.py file, when __init__.py is not present then I get the error:** \r\n``` python\r\nfrom sklearn.feature_extraction.stop_words import ENGLISH_STOP_WORDS\r\nfrom string import punctuation, uppercase\r\nfrom cpython.buffer cimport \\\r\n    PyBUF_SIMPLE, PyBUF_WRITABLE, \\\r\n    PyObject_CheckBuffer, PyObject_GetBuffer, PyBuffer_Release\r\nfrom .krovetzstemmer cimport KrovetzStemmer\r\n^\r\n------------------------------------------------------------\r\n\r\ncython/analyzer.pyx:57:0: relative cimport beyond main package is not allowed\r\n```\r\nI am not sure which of the three files `__init__.(pxd|pyx|py)` should I create in the cython folder and I finding it hard to debug exactly what's happening here.\r\nThanks,",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1559/comments",
    "created_at": "2016-12-21T04:07:48Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1559/events",
    "html_url": "https://github.com/cython/cython/issues/1559",
    "id": 196841629,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1559/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1559,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Unable to compile project with relative cimport using distutils",
    "updated_at": "2016-12-21T04:07:48Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1559",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2301364?v=3",
        "events_url": "https://api.github.com/users/se4u/events{/privacy}",
        "followers_url": "https://api.github.com/users/se4u/followers",
        "following_url": "https://api.github.com/users/se4u/following{/other_user}",
        "gists_url": "https://api.github.com/users/se4u/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/se4u",
        "id": 2301364,
        "login": "se4u",
        "organizations_url": "https://api.github.com/users/se4u/orgs",
        "received_events_url": "https://api.github.com/users/se4u/received_events",
        "repos_url": "https://api.github.com/users/se4u/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/se4u/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/se4u/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/se4u"
    }
}