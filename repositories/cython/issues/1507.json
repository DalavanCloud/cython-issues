{
    "assignee": null,
    "assignees": [],
    "body": "Calling `cythonize` with an instance of `setuptools.extension.Extension` raises an `AttributeError`.\nThe cause is that `setuptools.extension.Extension` subclasses [`distutils.extension.Extension`](https://github.com/python/cpython/blob/ee324a8f516318e84914ebd18f3e8068faec14f9/Lib/distutils/extension.py#L26), which is defined as an old-style class. These types can be [confirmed](http://stackoverflow.com/a/2654781/1959808) with:\n\n``` python\nimport distutils.core.Extension\nimport types\nimport setuptools.extension.Extension\n\nassert type(distutils.core.Extension) != types.TypeType\nassert type(setuptools.extension.Extension) != types.TypeType\n```\n\nThis behavior arises with:\n- `setuptools == 28.7.0`\n- `cython == 0.25.1`\n\nThis issue did not exist with earlier `cython` versions.\nCloser examination of the [docstring](https://github.com/cython/cython/blob/278a567621d586af74a1c845de0a1426b686c72e/Cython/Build/Dependencies.py#L768) of function `cythonize` reveals that one should pass a list of `Extension` objects:\n\n```\nAs module list, pass either a glob pattern, a list of glob patterns or a list of\n    Extension objects.  The latter allows you to configure the extensions separately\n    through the normal distutils options.\n```\n\nSo, my usage was wrong. Indeed, passing a `list` of `Extension` objects avoids the error. Since this error did not exist in the past, and because I believe that I followed some example when I initially wrote the code to pass an extension itself, I wonder whether this case is supposed to be supported, or if not, whether it should be emphasized in the docstring. Tracing the cause took a long time, especially because I assumed that `cythonize` was already properly called.\n\nOne workaround is to [create a new-style subclass](https://github.com/johnyf/dd/blob/af59d90a893c27d3070d6584297f671eb4fe2c20/download.py#L79):\n\n``` python\nclass Extension(setuptools.extension.Extension,object):\n    pass\n```\n\nThis works fine. Traceback from [`dd/download.py`](https://github.com/johnyf/dd/blob/af59d90a893c27d3070d6584297f671eb4fe2c20/download.py#L118) when `object` is removed from the above subclass definition:\n\n``` python\ndd:python setup.py install --cudd --linetrace\ncompile Cython extensions with line tracing\nTraceback (most recent call last):\n  File \"setup.py\", line 136, in <module>\n    run_setup()\n  File \"setup.py\", line 93, in run_setup\n    extensions = download.extensions(directives)\n  File \"/path/dd/download.py\", line 119, in extensions\n    v, compiler_directives=directives)\n  File \"~/.virtualenvs/dev/lib/python2.7/site-packages/Cython/Build/Dependencies.py\", line 809, in cythonize\n    aliases=aliases)\n  File \"~/.virtualenvs/dev/lib/python2.7/site-packages/Cython/Build/Dependencies.py\", line 648, in create_extension_list\n    elif isinstance(patterns, basestring) or not isinstance(patterns, collections.Iterable):\n  File \"~/.virtualenvs/dev/lib/python2.7/abc.py\", line 144, in __instancecheck__\n    return cls.__subclasscheck__(subtype)\n  File \"~/.virtualenvs/dev/lib/python2.7/abc.py\", line 180, in __subclasscheck__\n    if issubclass(subclass, scls):\n  File \"~/.virtualenvs/dev/lib/python2.7/abc.py\", line 180, in __subclasscheck__\n    if issubclass(subclass, scls):\n  File \"/home/ioannis/.virtualenvs/dev/lib/python2.7/abc.py\", line 161, in __subclasscheck__\n    ok = cls.__subclasshook__(subclass)\n  File \"~/.virtualenvs/dev/lib/python2.7/site-packages/backports_abc.py\", line 66, in __subclasshook__\n    mro = C.__mro__\nAttributeError: class Extension has no attribute '__mro__'\n```\n\nThe failure is due to the `isinstance(patterns, collections.Iterable)`. It can be reproduced as follows:\n\n``` python\nimport collections\n\nfrom Cython.Build import cythonize\nfrom setuptools.extension import Extension\n\na = Extension('foo', sources=['foo.pyx'])\n\nisinstance([a], collections.Iterable)  # works fine\nisinstance(a, collections.Iterable)  # raises `AttributeError`\n```\n\nI will report this issue also to `setuptools`, though it seems to me that defining an old-style class is intentional there.\n",
    "closed_at": null,
    "comment_data": [
        {
            "body": "Exactly seeing this error in my travis tests after update to 0.25.1. \r\n\r\n(updated since I see the workaround)",
            "created_at": "2016-10-30T00:57:07Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-257125085",
            "id": 257125085,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-10-30T00:58:26Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/257125085",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/138060?v=3",
                "events_url": "https://api.github.com/users/rainwoodman/events{/privacy}",
                "followers_url": "https://api.github.com/users/rainwoodman/followers",
                "following_url": "https://api.github.com/users/rainwoodman/following{/other_user}",
                "gists_url": "https://api.github.com/users/rainwoodman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rainwoodman",
                "id": 138060,
                "login": "rainwoodman",
                "organizations_url": "https://api.github.com/users/rainwoodman/orgs",
                "received_events_url": "https://api.github.com/users/rainwoodman/received_events",
                "repos_url": "https://api.github.com/users/rainwoodman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rainwoodman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rainwoodman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rainwoodman"
            }
        },
        {
            "body": "This seems to work fine for me (OS X and linux, Python 2.6 and 2.7)\r\n\r\n```\r\nIn [1]: import collections\r\nIn [2]: from setuptools.extension import Extension\r\nIn [3]: a = Extension('foo', sources=['foo.pyx'])\r\nIn [4]: isinstance(a, collections.Iterable)\r\nOut[4]: False\r\n```\r\n",
            "created_at": "2016-11-05T05:20:10Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258591770",
            "id": 258591770,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T05:20:10Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258591770",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            }
        },
        {
            "body": "Are you using the same version of `setuptools`?\r\n\r\nI am using `python == 2.7.11+` on Debian.",
            "created_at": "2016-11-05T05:33:16Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258592219",
            "id": 258592219,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T05:33:28Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258592219",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
                "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
                "followers_url": "https://api.github.com/users/johnyf/followers",
                "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
                "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/johnyf",
                "id": 3135273,
                "login": "johnyf",
                "organizations_url": "https://api.github.com/users/johnyf/orgs",
                "received_events_url": "https://api.github.com/users/johnyf/received_events",
                "repos_url": "https://api.github.com/users/johnyf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/johnyf"
            }
        },
        {
            "body": "Interesting, it works here too.",
            "created_at": "2016-11-05T05:34:55Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258592290",
            "id": 258592290,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T05:34:55Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258592290",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
                "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
                "followers_url": "https://api.github.com/users/johnyf/followers",
                "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
                "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/johnyf",
                "id": 3135273,
                "login": "johnyf",
                "organizations_url": "https://api.github.com/users/johnyf/orgs",
                "received_events_url": "https://api.github.com/users/johnyf/received_events",
                "repos_url": "https://api.github.com/users/johnyf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/johnyf"
            }
        },
        {
            "body": "Aha, found it again: @robertwb, you need to `from Cython.Build import cythonize`:\r\n\r\n```python\r\nimport collections\r\nfrom Cython.Build import cythonize\r\nfrom setuptools.extension import Extension\r\na = Extension('foo', sources=['foo.pyx'])\r\nisinstance(a, collections.Iterable)\r\n```",
            "created_at": "2016-11-05T05:40:38Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258592488",
            "id": 258592488,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T05:40:38Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258592488",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
                "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
                "followers_url": "https://api.github.com/users/johnyf/followers",
                "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
                "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/johnyf",
                "id": 3135273,
                "login": "johnyf",
                "organizations_url": "https://api.github.com/users/johnyf/orgs",
                "received_events_url": "https://api.github.com/users/johnyf/received_events",
                "repos_url": "https://api.github.com/users/johnyf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/johnyf"
            }
        },
        {
            "body": "Still not able to get it to fail\r\n\r\n```\r\nIn [1]: import collections\r\nIn [2]: from Cython.Build import cythonize\r\nIn [3]: from setuptools.extension import Extension\r\nIn [4]: a = Extension('foo', sources=['foo.pyx'])\r\nIn [5]: isinstance(a, collections.Iterable)\r\nOut[5]: False\r\nIn [6]: cythonize(a)\r\nOut[6]: [<setuptools.extension.Extension instance at 0x10933c368>]\r\n```",
            "created_at": "2016-11-05T05:51:37Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258592821",
            "id": 258592821,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T05:51:37Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258592821",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            }
        },
        {
            "body": "This was happening in one virtualenv of mine, but not a fresh one (nor the global one). The answer is in the traceback (see OP):\r\n\r\n```\r\nmkvirtualenv test\r\npip install cython backports_abc\r\npip freeze\r\nbackports-abc==0.4\r\nCython==0.25.1\r\n```\r\n\r\nThe error can then be reproduced. I do not know whether this classifies as a bug of [`backports_abc`](https://github.com/cython/backports_abc).",
            "created_at": "2016-11-05T06:17:49Z",
            "html_url": "https://github.com/cython/cython/issues/1507#issuecomment-258594011",
            "id": 258594011,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1507",
            "updated_at": "2016-11-05T06:18:13Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/258594011",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
                "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
                "followers_url": "https://api.github.com/users/johnyf/followers",
                "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
                "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/johnyf",
                "id": 3135273,
                "login": "johnyf",
                "organizations_url": "https://api.github.com/users/johnyf/orgs",
                "received_events_url": "https://api.github.com/users/johnyf/received_events",
                "repos_url": "https://api.github.com/users/johnyf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/johnyf"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1507/comments",
    "created_at": "2016-10-29T03:06:54Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
                "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
                "followers_url": "https://api.github.com/users/johnyf/followers",
                "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
                "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/johnyf",
                "id": 3135273,
                "login": "johnyf",
                "organizations_url": "https://api.github.com/users/johnyf/orgs",
                "received_events_url": "https://api.github.com/users/johnyf/received_events",
                "repos_url": "https://api.github.com/users/johnyf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/johnyf"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-10-29T03:15:48Z",
            "event": "renamed",
            "id": 840813383,
            "rename": {
                "from": "cythonize fails when given setuptools.extension.Extension",
                "to": "cythonize fails when given `setuptools.extension.Extension`"
            },
            "url": "https://api.github.com/repos/cython/cython/issues/events/840813383"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/138060?v=3",
                "events_url": "https://api.github.com/users/rainwoodman/events{/privacy}",
                "followers_url": "https://api.github.com/users/rainwoodman/followers",
                "following_url": "https://api.github.com/users/rainwoodman/following{/other_user}",
                "gists_url": "https://api.github.com/users/rainwoodman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rainwoodman",
                "id": 138060,
                "login": "rainwoodman",
                "organizations_url": "https://api.github.com/users/rainwoodman/orgs",
                "received_events_url": "https://api.github.com/users/rainwoodman/received_events",
                "repos_url": "https://api.github.com/users/rainwoodman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rainwoodman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rainwoodman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rainwoodman"
            },
            "commit_id": "485baba365fb72fdf78a7eeb0308c25536d23e1e",
            "commit_url": "https://api.github.com/repos/rainwoodman/pfft-python/commits/485baba365fb72fdf78a7eeb0308c25536d23e1e",
            "created_at": "2016-10-30T00:59:29Z",
            "event": "referenced",
            "id": 841053195,
            "url": "https://api.github.com/repos/cython/cython/issues/events/841053195"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            },
            "commit_id": "1d7072f17e00147e9929175d12b9c4ccf8ae90aa",
            "commit_url": "https://api.github.com/repos/cython/cython/commits/1d7072f17e00147e9929175d12b9c4ccf8ae90aa",
            "created_at": "2016-11-05T05:37:10Z",
            "event": "referenced",
            "id": 848719290,
            "url": "https://api.github.com/repos/cython/cython/issues/events/848719290"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-11-05T05:40:38Z",
            "event": "mentioned",
            "id": 848719924,
            "url": "https://api.github.com/repos/cython/cython/issues/events/848719924"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/486017?v=3",
                "events_url": "https://api.github.com/users/robertwb/events{/privacy}",
                "followers_url": "https://api.github.com/users/robertwb/followers",
                "following_url": "https://api.github.com/users/robertwb/following{/other_user}",
                "gists_url": "https://api.github.com/users/robertwb/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/robertwb",
                "id": 486017,
                "login": "robertwb",
                "organizations_url": "https://api.github.com/users/robertwb/orgs",
                "received_events_url": "https://api.github.com/users/robertwb/received_events",
                "repos_url": "https://api.github.com/users/robertwb/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/robertwb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/robertwb/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/robertwb"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-11-05T05:40:38Z",
            "event": "subscribed",
            "id": 848719925,
            "url": "https://api.github.com/repos/cython/cython/issues/events/848719925"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1507/events",
    "html_url": "https://github.com/cython/cython/issues/1507",
    "id": 186055873,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1507/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1507,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "cythonize fails when given `setuptools.extension.Extension`",
    "updated_at": "2016-11-05T06:18:13Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1507",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3135273?v=3",
        "events_url": "https://api.github.com/users/johnyf/events{/privacy}",
        "followers_url": "https://api.github.com/users/johnyf/followers",
        "following_url": "https://api.github.com/users/johnyf/following{/other_user}",
        "gists_url": "https://api.github.com/users/johnyf/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/johnyf",
        "id": 3135273,
        "login": "johnyf",
        "organizations_url": "https://api.github.com/users/johnyf/orgs",
        "received_events_url": "https://api.github.com/users/johnyf/received_events",
        "repos_url": "https://api.github.com/users/johnyf/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/johnyf/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/johnyf/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/johnyf"
    }
}