{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Minimal example:\r\n\r\n```python\r\n# foo.py\r\nclass Foo(object):\r\n    def __init__(self, x):\r\n        self.x = x\r\n\r\n    def foo(self):\r\n        return exp(self.x)\r\n\r\n# foo.pxd\r\ncdef extern from \"math.h\":\r\n    cpdef double exp(double x)\r\n\r\ncdef class Foo:\r\n    cdef double x\r\n    cpdef double foo(self)\r\n\r\n# bar.py\r\nfrom .foo import Foo\r\n\r\nclass Bar(Foo):\r\n    def bar(self):\r\n        return log(self.x)\r\n\r\n# bar.pxd\r\nfrom .foo cimport Foo\r\n\r\ncdef extern from \"math.h\":\r\n    cpdef double log(double x)\r\n\r\ncdef class Bar(Foo):\r\n    cpdef double bar(self)\r\n```\r\n\r\nCompiling with `cythonize -ai cython_ex/*.py`, `foo.py` compiles fine, but `bar.py` fails with:\r\n```\r\nx86_64-linux-gnu-gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -I/usr/include/python2.7 -c /home/arun/test/cython_ex/bar.c -o /home/arun/test/tmpxpPuhz/home/arun/test/cython_ex/bar.o\r\n/home/arun/test/cython_ex/bar.c:2409:13: error: redefinition of ‘__pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap’\r\n static char __pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap[] = \"wrap(x: float) -> float\";\r\n             ^\r\n/home/arun/test/cython_ex/bar.c:2261:13: note: previous definition of ‘__pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap’ was here\r\n static char __pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap[] = \"wrap(x: float) -> float\";\r\n             ^\r\n/home/arun/test/cython_ex/bar.c:2410:20: error: redefinition of ‘__pyx_mdef_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap’\r\n static PyMethodDef __pyx_mdef_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap = {\"wrap\", (PyCFunction)__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap, METH_O, __pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap};\r\n                    ^\r\n/home/arun/test/cython_ex/bar.c:2262:20: note: previous definition of ‘__pyx_mdef_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap’ was here\r\n static PyMethodDef __pyx_mdef_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap = {\"wrap\", (PyCFunction)__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap, METH_O, __pyx_doc_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap};\r\n                    ^\r\n/home/arun/test/cython_ex/bar.c:2411:18: error: redefinition of ‘__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap’\r\n static PyObject *__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap(PyObject *__pyx_self, PyObject *__pyx_arg_x) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2263:18: note: previous definition of ‘__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap’ was here\r\n static PyObject *__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap(PyObject *__pyx_self, PyObject *__pyx_arg_x) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2432:18: error: redefinition of ‘__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap’\r\n static PyObject *__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap(PyObject *__pyx_self, double __pyx_v_x) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2284:18: note: previous definition of ‘__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap’ was here\r\n static PyObject *__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap(PyObject *__pyx_self, double __pyx_v_x) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2485:18: error: redefinition of ‘__Pyx_CFunc_double____double___to_py’\r\n static PyObject *__Pyx_CFunc_double____double___to_py(double (*__pyx_v_f)(double)) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2337:18: note: previous definition of ‘__Pyx_CFunc_double____double___to_py’ was here\r\n static PyObject *__Pyx_CFunc_double____double___to_py(double (*__pyx_v_f)(double)) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2337:18: warning: ‘__Pyx_CFunc_double____double___to_py’ defined but not used [-Wunused-function]\r\n/home/arun/test/cython_ex/bar.c:2411:18: warning: ‘__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap’ defined but not used [-Wunused-function]\r\n static PyObject *__pyx_pw_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_1wrap(PyObject *__pyx_self, PyObject *__pyx_arg_x) {\r\n                  ^\r\n/home/arun/test/cython_ex/bar.c:2432:18: warning: ‘__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap’ defined but not used [-Wunused-function]\r\n static PyObject *__pyx_pf_11cfunc_dot_to_py_36__Pyx_CFunc_double____double___to_py_wrap(PyObject *__pyx_self, double __pyx_v_x) {\r\n                  ^\r\nerror: command 'x86_64-linux-gnu-gcc' failed with exit status 1\r\n```\r\n\r\nChanging `bar.pxd` to\r\n```cython\r\nfrom .foo cimport Foo\r\n\r\ncdef extern from *:\r\n    cpdef double log(double x)\r\n\r\ncdef class Bar(Foo):\r\n    cpdef double bar(self)\r\n```\r\nalso fails with the same error.\r\n\r\nIt's quite possible I'm just doing something stupid.\r\n\r\nA workaround is as follows:\r\n```cython\r\n# foo.pxd\r\ncdef extern from \"math.h\":\r\n    cpdef double exp(double x)\r\n    cpdef double log(double x)\r\n\r\ncdef class Foo:\r\n    cdef double x\r\n    cpdef double foo(self)\r\n\r\n# bar.pxd\r\nfrom .foo cimport Foo, log\r\n\r\ncdef class Bar(Foo):\r\n    cpdef double bar(self)\r\n```\r\n\r\ntested both on cython 0.27 and master (`f9d111469`).\r\nPython 2.7.6\r\nUbuntu 14.04.5",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2073/comments",
    "created_at": "2018-01-16T12:36:50Z",
    "event_data": [],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2073/events",
    "html_url": "https://github.com/cython/cython/issues/2073",
    "id": 288891884,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2073/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 2073,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "C compilation fails when using `cdef extern` in subclassed pxd file.",
    "updated_at": "2018-01-16T12:36:50Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2073",
    "user": {
        "avatar_url": "https://avatars3.githubusercontent.com/u/19927736?v=4",
        "events_url": "https://api.github.com/users/al626/events{/privacy}",
        "followers_url": "https://api.github.com/users/al626/followers",
        "following_url": "https://api.github.com/users/al626/following{/other_user}",
        "gists_url": "https://api.github.com/users/al626/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/al626",
        "id": 19927736,
        "login": "al626",
        "organizations_url": "https://api.github.com/users/al626/orgs",
        "received_events_url": "https://api.github.com/users/al626/received_events",
        "repos_url": "https://api.github.com/users/al626/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/al626/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/al626/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/al626"
    }
}