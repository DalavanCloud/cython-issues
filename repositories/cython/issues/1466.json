{
    "assignee": null,
    "assignees": [],
    "body": "I'm transferring this bug report over from the google group so that it can officially be tracked:\r\nhttps://groups.google.com/forum/#!topic/cython-users/Eu-wV4Z9AIs\r\n\r\nI have some complicated Cython code that was previously cythonizing under Cython 0.22.1, but upon upgrading to 0.24.1, I get the following error:\r\n\r\n```\r\nError compiling Cython file:\r\n------------------------------------------------------------\r\n...\r\n\r\n\r\ncdef extern from *:\r\n    object PyErr_Format(exc, const char *format, ...)\r\n\r\n\r\n@cname(\"__Pyx_carray_from_py_float32__t\")\r\ncdef int __Pyx_carray_from_py_float32__t(object o, float32_t *v, Py_ssize_t length) except -1:\r\n                                                  ^\r\n------------------------------------------------------------\r\n\r\n\r\ncarray.from_py:77:51: 'float32_t' is not a type identifier\r\n```\r\n\r\nThe code compiles with 0.23 but fails with 0.23.1.\r\n\r\nGit bisect shows the following:\r\n\r\n```\r\nBisecting: 0 revisions left to test after this (roughly 0 steps)\r\n[77bb90df88f85ec6e45d4c78278134f037d56829] changelog\r\nrunning python cython.py /zzz/xxx/xxx/xxx/xxx/fxxx.pyx\r\n27f8ddb6b2a16d5fe938a42a9655a1919b21161a is the first bad commit\r\ncommit 27f8ddb6b2a16d5fe938a42a9655a1919b21161a\r\nAuthor: Stefan Behnel <stefan_ml@behnel.de>\r\nDate:   Sun Aug 9 20:26:19 2015 +0200\r\n\r\n    fix #855: make \"import *\" include all necessary \"from_py\" coercion helper functions\r\n\r\n:100644 100644 327d7af8715cd01870e05af0ee9abd58e4a44fd2 0791de3333b36297e6bee9763a73c3e0efbb06bd M\tCHANGES.rst\r\n:040000 040000 dcd52de7aef911aff50b42e5cbe4fa5e15a59139 ea63ef0a74ad50578822fd9498e84fcca7623c2e M\tCython\r\n:040000 040000 bd3ec17792950a24455efcda7bf2b68aa1cbbe1f c33384d25df25f67037bc1da1370cf863f34b649 M\ttests\r\nbisect run success\r\n```\r\n\r\nHere is a minimal example that seems to reproduce the bug:\r\nhttps://gist.github.com/synapticarbors/99270d9c90114948c325a16212b48353\r\n\r\nThe line that triggers the error is:\r\n\r\n```\r\ncdef YPAIR pairs[MAXR] \r\n```\r\n\r\nAlso strangely I uncovered another bug related to “import *” a while back that did get fixed in the 0.24 release:\r\nhttps://groups.google.com/d/msg/cython-users/MY33Mryneuo/qgCFDJXHCwAJ \r\n\r\nI’m not sure if this is somehow related.",
    "closed_at": null,
    "comment_data": [
        {
            "body": "I wanted to report that I'm still getting the same error in the `0.25b0` release. ",
            "created_at": "2016-10-11T00:33:40Z",
            "html_url": "https://github.com/cython/cython/issues/1466#issuecomment-252781314",
            "id": 252781314,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1466",
            "updated_at": "2016-10-11T00:33:40Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/252781314",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/589279?v=3",
                "events_url": "https://api.github.com/users/synapticarbors/events{/privacy}",
                "followers_url": "https://api.github.com/users/synapticarbors/followers",
                "following_url": "https://api.github.com/users/synapticarbors/following{/other_user}",
                "gists_url": "https://api.github.com/users/synapticarbors/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/synapticarbors",
                "id": 589279,
                "login": "synapticarbors",
                "organizations_url": "https://api.github.com/users/synapticarbors/orgs",
                "received_events_url": "https://api.github.com/users/synapticarbors/received_events",
                "repos_url": "https://api.github.com/users/synapticarbors/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/synapticarbors/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/synapticarbors/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/synapticarbors"
            }
        },
        {
            "body": "I can get your example to compile by 1) removing the \"from tlib import *\" and keeping only the cimport, and then 2) adding an empty tlib.pyx file and compiling it. That module is actually required, because otherwise the \"pairs\" and \"tw\" variables are only declared but do not actually exist anywhere.\r\n\r\nI admit that the compiler crash is a bug, but it's not entirely clear to me what you intend with that code. I assume there is an actual tlib.pyx module? Why do you need to do both an import and a cimport on it? And why do you need star-imports for both? They are generally a bad idea, but for mixed import/cimport scenarios, they are a *really* bad idea, because the star-import will make Cython generate Python wrappers for all sorts of C things that are declared at the C level, thus unnecessarily bloating your module with code that will never be used (such as the code that is crashing here).",
            "created_at": "2016-10-15T09:36:00Z",
            "html_url": "https://github.com/cython/cython/issues/1466#issuecomment-253973404",
            "id": 253973404,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1466",
            "updated_at": "2016-10-15T09:36:00Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/253973404",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=3",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            }
        },
        {
            "body": "@scoder Thanks for taking a look at this issue. In the real code there is the equivalent of `tlib.pyx`. I also know that the `import *` is generally a bad idea. Unfortunately there are some user demands of having methods accessible from a few different modules without thinking about where they came from. Again, I wholly acknowledge that this is terrible, but the library users have been doing this for a while and I don't want to break compatibility if possible.  ",
            "created_at": "2016-10-17T19:50:29Z",
            "html_url": "https://github.com/cython/cython/issues/1466#issuecomment-254313721",
            "id": 254313721,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/1466",
            "updated_at": "2016-10-17T19:50:29Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/254313721",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/589279?v=3",
                "events_url": "https://api.github.com/users/synapticarbors/events{/privacy}",
                "followers_url": "https://api.github.com/users/synapticarbors/followers",
                "following_url": "https://api.github.com/users/synapticarbors/following{/other_user}",
                "gists_url": "https://api.github.com/users/synapticarbors/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/synapticarbors",
                "id": 589279,
                "login": "synapticarbors",
                "organizations_url": "https://api.github.com/users/synapticarbors/orgs",
                "received_events_url": "https://api.github.com/users/synapticarbors/received_events",
                "repos_url": "https://api.github.com/users/synapticarbors/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/synapticarbors/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/synapticarbors/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/synapticarbors"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/1466/comments",
    "created_at": "2016-09-21T16:43:36Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=3",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-10-17T19:50:29Z",
            "event": "mentioned",
            "id": 826481419,
            "url": "https://api.github.com/repos/cython/cython/issues/events/826481419"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/491659?v=3",
                "events_url": "https://api.github.com/users/scoder/events{/privacy}",
                "followers_url": "https://api.github.com/users/scoder/followers",
                "following_url": "https://api.github.com/users/scoder/following{/other_user}",
                "gists_url": "https://api.github.com/users/scoder/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/scoder",
                "id": 491659,
                "login": "scoder",
                "organizations_url": "https://api.github.com/users/scoder/orgs",
                "received_events_url": "https://api.github.com/users/scoder/received_events",
                "repos_url": "https://api.github.com/users/scoder/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/scoder/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/scoder/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/scoder"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2016-10-17T19:50:29Z",
            "event": "subscribed",
            "id": 826481420,
            "url": "https://api.github.com/repos/cython/cython/issues/events/826481420"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/1466/events",
    "html_url": "https://github.com/cython/cython/issues/1466",
    "id": 178401755,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/1466/labels{/name}",
    "locked": false,
    "milestone": null,
    "number": 1466,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "open",
    "title": "Regression in carray.from_py",
    "updated_at": "2016-10-17T19:50:29Z",
    "url": "https://api.github.com/repos/cython/cython/issues/1466",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/589279?v=3",
        "events_url": "https://api.github.com/users/synapticarbors/events{/privacy}",
        "followers_url": "https://api.github.com/users/synapticarbors/followers",
        "following_url": "https://api.github.com/users/synapticarbors/following{/other_user}",
        "gists_url": "https://api.github.com/users/synapticarbors/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/synapticarbors",
        "id": 589279,
        "login": "synapticarbors",
        "organizations_url": "https://api.github.com/users/synapticarbors/orgs",
        "received_events_url": "https://api.github.com/users/synapticarbors/received_events",
        "repos_url": "https://api.github.com/users/synapticarbors/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/synapticarbors/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/synapticarbors/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/synapticarbors"
    }
}