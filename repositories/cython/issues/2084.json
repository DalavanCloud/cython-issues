{
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "Cython is great, thank you for an amazing tool.\r\n\r\nSystem: Ubuntu Xenial (16.04) x86_64 with python 3.5.2\r\nSetup a virtual environment that has numpy installed via pip (and not installed system-wide).\r\n\r\n```python\r\n# test_cy.pyx\r\nimport numpy\r\nprint( numpy.random.randint(9) )\r\n```\r\n\r\nAs a module, this works just fine:\r\n```\r\n(venv) $ cython test_cy.pyx\r\n(venv) $ gcc -I /usr/include/python3.5m test_cy.c -lpython3.5m -fPIC -shared -o test_cy.so\r\n(venv) $ python -c 'import test_cy'\r\n6\r\n```\r\n\r\nIf however, instead of creating a shared object library, cython is asked to create an executable, this will fail.\r\n```\r\n(venv) $ cython test_cy.pyx --embed\r\n(venv) $ gcc -I /usr/include/python3.5m test_cy.c -lpython3.5m -fPIC -o test_cy\r\n(venv) $ ./test_cy\r\nTraceback (most recent call last):\r\n  File \"test_cy.pyx\", line 1, in init test_cy\r\n    import numpy\r\nImportError: No module named 'numpy'\r\n```\r\n\r\nWhat's really confusing is that if numpy is then installed system-wide via `sudo apt-get install python3-numpy` this executable works without recompilation. For some reason, the shared object is fine working in a virtual environment but the binary produced with `--embed` is not.\r\n\r\nIs this a bug or am I doing something wrong?\r\n\r\nI believe this is the same issue seen here that has had no resolution for six years:\r\nhttps://groups.google.com/forum/#!topic/cython-users/ZVgGzeAIHrA",
    "closed_at": "2018-02-26T06:24:57Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "I was able to resolve this by setting `PYTHONPATH` to the path of the virtualenv's `site-packages`.",
            "created_at": "2018-02-26T06:24:57Z",
            "html_url": "https://github.com/cython/cython/issues/2084#issuecomment-368402587",
            "id": 368402587,
            "issue_url": "https://api.github.com/repos/cython/cython/issues/2084",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODQwMjU4Nw==",
            "updated_at": "2018-02-26T09:46:33Z",
            "url": "https://api.github.com/repos/cython/cython/issues/comments/368402587",
            "user": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/26192908?v=4",
                "events_url": "https://api.github.com/users/a6/events{/privacy}",
                "followers_url": "https://api.github.com/users/a6/followers",
                "following_url": "https://api.github.com/users/a6/following{/other_user}",
                "gists_url": "https://api.github.com/users/a6/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/a6",
                "id": 26192908,
                "login": "a6",
                "node_id": "MDQ6VXNlcjI2MTkyOTA4",
                "organizations_url": "https://api.github.com/users/a6/orgs",
                "received_events_url": "https://api.github.com/users/a6/received_events",
                "repos_url": "https://api.github.com/users/a6/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/a6/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/a6/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/a6"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/cython/cython/issues/2084/comments",
    "created_at": "2018-01-27T04:04:53Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars2.githubusercontent.com/u/26192908?v=4",
                "events_url": "https://api.github.com/users/a6/events{/privacy}",
                "followers_url": "https://api.github.com/users/a6/followers",
                "following_url": "https://api.github.com/users/a6/following{/other_user}",
                "gists_url": "https://api.github.com/users/a6/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/a6",
                "id": 26192908,
                "login": "a6",
                "node_id": "MDQ6VXNlcjI2MTkyOTA4",
                "organizations_url": "https://api.github.com/users/a6/orgs",
                "received_events_url": "https://api.github.com/users/a6/received_events",
                "repos_url": "https://api.github.com/users/a6/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/a6/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/a6/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/a6"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2018-02-26T06:24:57Z",
            "event": "closed",
            "id": 1491320312,
            "node_id": "MDExOkNsb3NlZEV2ZW50MTQ5MTMyMDMxMg==",
            "url": "https://api.github.com/repos/cython/cython/issues/events/1491320312"
        }
    ],
    "events_url": "https://api.github.com/repos/cython/cython/issues/2084/events",
    "html_url": "https://github.com/cython/cython/issues/2084",
    "id": 292088021,
    "labels": [],
    "labels_url": "https://api.github.com/repos/cython/cython/issues/2084/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUyOTIwODgwMjE=",
    "number": 2084,
    "repository_url": "https://api.github.com/repos/cython/cython",
    "state": "closed",
    "title": "cython --embed binary fails when in a virtualenv",
    "updated_at": "2018-02-26T09:46:33Z",
    "url": "https://api.github.com/repos/cython/cython/issues/2084",
    "user": {
        "avatar_url": "https://avatars2.githubusercontent.com/u/26192908?v=4",
        "events_url": "https://api.github.com/users/a6/events{/privacy}",
        "followers_url": "https://api.github.com/users/a6/followers",
        "following_url": "https://api.github.com/users/a6/following{/other_user}",
        "gists_url": "https://api.github.com/users/a6/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/a6",
        "id": 26192908,
        "login": "a6",
        "node_id": "MDQ6VXNlcjI2MTkyOTA4",
        "organizations_url": "https://api.github.com/users/a6/orgs",
        "received_events_url": "https://api.github.com/users/a6/received_events",
        "repos_url": "https://api.github.com/users/a6/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/a6/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/a6/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/a6"
    }
}